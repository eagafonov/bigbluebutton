<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
        <head>
                <title></title>
                <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
                <style type="text/css" media="screen">
                        html, body,  { height:100% }
                        body                                    { margin:0; padding:0; overflow:hidden; }
                        #altContent                             { /* style alt content */ }
                        #content    { height:100%;}
                        body {
                             background-color:lightgray;
                        }

                        .deskshare_viewer {
                            border-style:solid;
                            border-width:1px;
                            margin: 5px;
                        }
                </style>
                <script type="text/javascript" src="swfobject/swfobject.js"></script>

                <script type="text/javascript">
                        swfobject.registerObject("BigBlueButton", "10.3.0", "expressInstall.swf");
                </script>
                <script src="lib/jquery-1.5.1.min.js" language="javascript"></script>
                <script src="lib/bbb_deskshare_viewer.js" language="javascript"></script>

                <script language="javascript">

                    function flash_trace(message) {
                        console.log("[FLASH]", message);
                    }

                    function createReplayer(containerId, objectId, flashvars) {
                        jQuery('<div>').appendTo('#'+containerId).attr('id', objectId);

                        // For version detection, set to min. required Flash Player version, or 0 (or 0.0.0), for no version detection.
                        var swfVersionStr = "11.1.0";
                        // To use express install, set to playerProductInstall.swf, otherwise the empty string.
                        var xiSwfUrlStr = "playerProductInstall.swf";

                        var params = {};
                        params.quality = "high";
                        params.bgcolor = "#888888";
                        params.allowscriptaccess = "always";
                        params.allowfullscreen = "true";
                        params.wmode = "transparent";

                        // flashvars.ID must be set
                        flashvars.ID = objectId;

                        var attributes = {};
                        attributes.id = objectId;
                        attributes.name = objectId;
                        attributes.classname = "deskshare_viewer";
                        attributes.align = "middle";

                        // Get intial handler for newly created SWF
                        // must be done before SWF object is actually created, otherwize some initial calls will be missed.
                        var handler = window.bbbDeskshareViewer.createHandler(flashvars.ID);
                        console.log("[MAIN] Handler initial", handler);

                        // Populate handler with callbacks
                        handler.onCreated = function() {console.log("[MAIN] Viewer created")};
                        handler.onViewStart = function() {console.log("[MAIN] Viewer stream start")};
                        handler.onViewStop = function() {console.log("[MAIN] Viewer stream stop")};

                        console.log("[MAIN] Handler updated", handler);

                        swfobject.embedSWF(
                            "DeskshareStandalone.swf?v=VERSION", objectId,
                            "100px", "100px",
                            swfVersionStr, xiSwfUrlStr,
                            flashvars, params, attributes);

                        $("#"+objectId).addClass('deskshare_viewer');


                    }

                    function setViewerSize(w, h) {
                        $('#deskshareswf').attr('width', w).attr('height', h);
                    }

                    $(document).ready(function() {
                            var flashvars = {};

                            if (window.location.hash) {
                                var parts = window.location.hash.substring(1).split(';');

                                jQuery.each(parts, function(i,e) {
                                        name_val = e.split('=', 2);
                                        flashvars[name_val[0]] = name_val[1];
                                    });
                            }

                            createReplayer('content', 'deskshareswf', flashvars);
                        });

                </script>
        </head>
        <body>
                <div>
                <input type='button' value='1x1' onclick="setViewerSize('1px', '1px')">
                <input type='button' value='100x100' onclick="setViewerSize('100px', '100px')">
                <input type='button' value='800x600' onclick="setViewerSize('800px', '600px')">
                <input type='button' value='1000x1000' onclick="setViewerSize('1000px', '1000px')">
                <input type='button' value='100% x 100%' onclick="setViewerSize('100%', '100%')">
                </div>
                <div id="content">
                </div>
        </body>
</html>
