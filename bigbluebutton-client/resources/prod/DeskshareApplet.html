<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
        <head>
                <title></title>
                <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
                <style type="text/css" media="screen">
                        html, body, #content    { height:100%; }
                        body                                    { margin:0; padding:0; overflow:hidden; }
                        #altContent                             { /* style alt content */ }
                        .applet {width:1px; height:1px;}
                </style>
                <script src="lib/jquery-1.5.1.min.js" language="javascript"></script>

                <script language="javascript">
                    function guidGenerator() {
                        var S4 = function() {
                        return (((1+Math.random())*0x10000)|0).toString(16).substring(1);
                        };
                        return (S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4());
                    }


                    gRoom = guidGenerator();

                    gServerHost = window.location.hostname;

                    rtmp_url = "rtmp://"+gServerHost+":3935/deskShare";

                    gLink = 'DeskshareStandalone.html#HOST='+rtmp_url+';ROOM='+gRoom;

                    function createApplet(id, host, room) {
                        var applet = $("<applet>").attr('code', 'org.bigbluebutton.deskshare.client.DeskShareApplet.class')
                                                  .attr('archive', 'bbb-deskshare-applet-0.8.jar')
                                                  .attr('id', id)
                                                  .addClass('applet');

                        $("<param/>").attr('name', 'ROOM').attr('value', room).appendTo(applet);
                        $("<param/>").attr('name', 'IP').attr('value', host).appendTo(applet);
                        $("<param/>").attr('name', 'PORT').attr('value', 9123).appendTo(applet);
                        $("<param/>").attr('name', 'FULLSCREEN').attr('value', 'fullscreen').appendTo(applet);

                        return applet;
                    }

                    function addApplet(containerId, host, room) {
                        var applet = createApplet(containerId + "_applet", host, gRoom);

                        $("#" + containerId).append(applet);
                        $("#mydesktop_link").attr('href', gLink).text(gLink);
                    }

                    function stopApplet(containerId) {
                        var applet = $("#" + containerId + "_applet");
                        $("#" + containerId).empty();
                        $("#mydesktop_link").removeAttr('href').empty();
                    }

                    $(document).ready(function() {
                            $("#mydesktop_link").removeAttr('href').empty();
                        })
				</script>

        </head>
        <body>
                <input type='submit' value='Start desktop sharing' onclick='addApplet("appletContainer", gServerHost, gRoom)' />
                <input type='submit' value='Stop desktop sharing' onclick='stopApplet("appletContainer")' />
                <div>
                <a id='mydesktop_link' target='_blank'>!!SETUPME</a>
                </div>
                <div id='appletContainer' />

        </body>
</html>
